




<!DOCTYPE html>
<html
  lang="en-us"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="rgb(255,255,255)" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Integrating Asyncronous iperf3 Tests in Android 11&#43; &middot; matt9j:Matt Johnson</title>
    <meta name="title" content="Integrating Asyncronous iperf3 Tests in Android 11&#43; &middot; matt9j:Matt Johnson" />
  
  <meta name="description" content="C&#43;&#43; also builds character ðŸ˜…" />
  
  
  
  <link rel="canonical" href="https://matt9j.net/posts/integrating-iperf/" />
  
  
  
  
  
  
  
  
  
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.2ca0a44f9db806817c273b488945a6fe2483777b2918234b7ea49fe8651f3a0c.css"
    integrity="sha256-LKCkT524BoF8JztIiUWm/iSDd3spGCNLfqSf6GUfOgw="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.022d0ebc3b46a335eb1c7ef79b7f2de143d7cd5156d433638592ef1ce5f8554e.js" integrity="sha256-Ai0OvDtGozXrHH73m38t4UPXzVFW1DNjhZLvHOX4VU4="></script>
  
  
  
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Integrating Asyncronous iperf3 Tests in Android 11&#43;" />
<meta property="og:description" content="C&#43;&#43; also builds character ðŸ˜…" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://matt9j.net/posts/integrating-iperf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-30T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Integrating Asyncronous iperf3 Tests in Android 11&#43;"/>
<meta name="twitter:description" content="C&#43;&#43; also builds character ðŸ˜…"/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Integrating Asyncronous iperf3 Tests in Android 11\u002b",
    "headline": "Integrating Asyncronous iperf3 Tests in Android 11\u002b",
    "description": "C\u002b\u002b also builds character ðŸ˜…",
    "abstract": "Preamble # I\u0026rsquo;ve been helping out the Seattle Community Network (SCN), with an ongoing project to build a crowdsourced network performance measurement application for Android.",
    "inLanguage": "en-us",
    "url" : "https:\/\/matt9j.net\/posts\/integrating-iperf\/",
    "author" : {
      "@type": "Person",
      "name": "Matt Johnson"
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-09-30T00:00:00\u002b00:00",
    "datePublished": "2021-09-30T00:00:00\u002b00:00",
    
    "dateModified": "2021-09-30T00:00:00\u002b00:00",
    
    "keywords": ["android","seattle-community-network","networks","ICTD"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1815"
  }]
  </script>


  
  <meta name="author" content="Matt Johnson" />
  
    
      <link href="https://github.com/matt9j" rel="me" />
    
      <link href="https://scholar.google.com/citations?user=cTILBksAAAAJ&amp;hl=en" rel="me" />
    
      <link href="https://keybase.io/matt9j" rel="me" />
    
      <link href="https://linkedin.com/in/matt9j" rel="me" />
    
      <link href="https://orcid.org/0000-0003-2095-0225" rel="me" />
    
      <link href="https://twitter.com/matt9j" rel="me" />
    
  
  
  






  
  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold pe-2 text-primary-600 dark:text-primary-400">&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10">
  <nav class="flex items-start justify-between sm:items-center">
    
    <div class="flex flex-row items-center">
      
  <a
    class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
    rel="me"
    href="/"
    >matt9j:Matt Johnson</a
  >

      

    </div>
    
    
      <ul class="flex list-none flex-col ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/posts/"
                  title="Posts"
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Posts</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/publications/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Publications</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/recipes/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Recipes</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/categories/"
                  title="Categories"
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Categories</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/contact/"
                  title="Contact"
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Contact</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/about/"
                  title="About Me"
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >About Me</span
                    >
                  </a
                >
              
            </li>
          
          
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Integrating Asyncronous iperf3 Tests in Android 11+
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2021-09-30 00:00:00 &#43;0000 UTC">September 30, 2021</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span>
    

    
    
  </div>

  
  


      </div>
      
    </header>
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      <div class="min-w-0 min-h-0 max-w-prose grow">
        <h2 id="preamble" class="relative group">Preamble <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#preamble" aria-label="Anchor">#</a></span></h2>
<p>I&rsquo;ve been helping out the <a
  href="https://seattlecommunitynetwork.org"
  
  target="_blank" rel="noreferrer noopener"
>Seattle Community
Network</a> (SCN), with an ongoing project to
build a crowdsourced network performance measurement application for Android.
While understanding modern network performance, particularly wireless networks,
is <em>extremely</em> subtle, &ldquo;speedtests&rdquo; offer a crude yet popular way to measure a
network&rsquo;s performance, and are easy for general audiences to interpret.</p>
<p>Unsurprisingly, SCN sought to include a &ldquo;speedtest&rdquo; capability in their app! A
team of an undergraduate researcher (<a
  href="https://johnnzhou.github.io/"
  
  target="_blank" rel="noreferrer noopener"
>Zhennan(John)
Zhou</a>) and a volunteer high school student
(<a
  href="https://www.linkedin.com/in/ashwin-chintalapati-a54936222/"
  
  target="_blank" rel="noreferrer noopener"
>Ashwin
Chintalapati</a>)
organized by <a
  href="https://infrared-ether.medium.com/"
  
  target="_blank" rel="noreferrer noopener"
>Esther Jang</a> got started on
the project, and started integrating <a
  href="https://github.com/esnet/iperf"
  
  target="_blank" rel="noreferrer noopener"
>iperf3</a>
(C, <a
  href="https://github.com/esnet/iperf/blob/master/LICENSE"
  
  target="_blank" rel="noreferrer noopener"
>BSD-3</a> into the
application. Due to its maturity, consistent history of open source activity,
and explicit offer of &ldquo;a library version of the functionality that can be used
in other programs,&rdquo; I thought it was a reasonable choice. After a couple of
weeks their efforts stalled though, and I was asked for some input.</p>
<p>This marked the beginning of the journey&hellip;</p>
<p>For part one, see my prior post <a
  href="/posts/building-iperf/"
  
  
>Building iperf3 For Android 11+</a></p>
<h2 id="integrating-iperf3-with-an-android-application" class="relative group">Integrating iperf3 with an Android Application <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#integrating-iperf3-with-an-android-application" aria-label="Anchor">#</a></span></h2>
<p>Once we had a stable way to build libiperf, it was time to actually integrate
its functionality into our application to provide the &ldquo;speedtest&rdquo; capability.
Since the test would run for 10s of seconds, we needed it to operate
asynchronously and not block the main UI thread. The team also wanted the test
to be able to complete if the user switches away from the application while the
test is running. Android has a <a
  href="https://developer.android.com/guide/background"
  
  target="_blank" rel="noreferrer noopener"
>great flowchart in their developer
documentation</a> for deciding
where and how to run tasks in modern Android. Since the test needed to be
decoupled from the main application context (to allow switching), the team
selected AndroidX&rsquo;s <code>WorkManager</code>
(<a
  href="https://developer.android.com/topic/libraries/architecture/workmanager"
  
  target="_blank" rel="noreferrer noopener"
>Overview</a>
<a
  href="https://developer.android.com/reference/androidx/work/WorkManager"
  
  target="_blank" rel="noreferrer noopener"
>Ref</a>).</p>
<p>At a high-level, <code>WorkManager</code> allows the application to schedule work requests
for either one-time work or periodic work. It has some cool capabilities to put
constraints on when tasks run (like requiring a WiFi connection, when not on
battery, when the device is idle, etc.), and an entire process for managing work
windows for periodic maintenance tasks. Fortunately our task is relatively
straightforward: we want to immediately run a test in response to user input,
allow users to chancel running tests if they start one by mistake, and get the
results of the test upon completion.</p>
<p>The <code>Worker</code> class
(<a
  href="https://developer.android.com/reference/androidx/work/Worker"
  
  target="_blank" rel="noreferrer noopener"
>Ref</a>) provides a
synchronous interface for running work in its <code>doWork()</code> method and can be
enqueued in the <code>WorkManager</code> to execute immediately. Since libiperf is a C
library, we call a native C function across the Java Native Interface which
initializes the iperf test c-struct with the intended test parameters and starts
the test. All of this works well enough, and allows us to run a single iperf
test to completion. At this point things start to get a bit more interesting&hellip;</p>
<h2 id="stopping-iperf3-tests" class="relative group">Stopping iperf3 tests <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#stopping-iperf3-tests" aria-label="Anchor">#</a></span></h2>
<p>It was an important feature that in-progress tests could be cancelled in case a
heavyweight test was started accidentally! The WorkManager provides a
<a
  href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/managing-work#cancelling"
  
  target="_blank" rel="noreferrer noopener"
>straightforward
API</a>
to cancel enqueued or in-progress work. The <code>Worker</code> class presents a
synchronous interface though&ndash; how does the stop signal get to the worker? It
turns out there are two ways, either by providing an override for the
<code>onStopped()</code> callback, or by polling the <code>isStopped()</code> property in the main
<code>doWork()</code> method. Since our <code>doWork()</code> method just indirectly wraps the
underlying libiperf <code>run_client()</code> function, which is also synchronous and
blocks on an underlying select(), there would not be an easy way to regularly
poll <code>isStopped()</code> during the test without extensively modifying libiperf.</p>
<p>Examining the source code for the <a
  href="https://github.com/esnet/iperf/blob/master/src/main.c"
  
  target="_blank" rel="noreferrer noopener"
>main iperf3 command line
program</a>, which is
implemented with libiperf and supports cancellation, we saw that they handle
test cancellation by intercepting SIGINT, SIGTERM, and SIGHUP and calling
<code>iperf_got_sigend()</code> from the libiperf api whenever one of the signals is
received. This looked promising and easy to integrate with the <code>isStopped()</code>
worker callback! So we connected the callbacks, started a test, pressed the
cancel button, and&hellip;</p>
<p>watched our app crash.</p>
<p>Well not exactly crash, just, close? Digging into the implementation of
<code>iperf_got_sigend()</code> quickly reveals a surprising twist for an embeddable api&hellip;
a call to <code>exit()</code>!</p>
<h3 id="process-assumptions-in-the-libiperf-api" class="relative group">Process assumptions in the libiperf API <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#process-assumptions-in-the-libiperf-api" aria-label="Anchor">#</a></span></h3>
<p>It turns out that the iperf API wasn&rsquo;t quite as embeddable as we had originally
hoped, and really was designed for implementing iperf-like command line
programs instead of providing iperf as a part of a larger application. In
Android the entire application is kept within the same process, including our
background workers and the foreground UI. Calling exit doesn&rsquo;t just stop the
background worker, but terminates the entire process/application! We wouldn&rsquo;t be
able to stop our test the same way, and would have to figure out something else.</p>
<h3 id="manually-setting-the-done-flag" class="relative group">Manually setting the done flag <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#manually-setting-the-done-flag" aria-label="Anchor">#</a></span></h3>
<p>Deep into the libiperf source at this point, we noticed a boolean <code>done</code> flag
being checked in the client loop, but no high-level api to set it outside
<code>iperf_got_sigend()</code>. Setting it to true appeared to cause the client to break
out of its main run loop and return, exactly the behavior we wanted! Setting it
directly required extending the libiperf API, and we&rsquo;re planning to upstream
these changes for future integrators.</p>
<p>But there is no magic&ndash; since the <code>done</code> flag is only checked at each iteration
of the run loop, we still have to work around the blocking select at its heart.
For uplink tests the loop runs with every transmitted packet, providing plenty
of responsiveness. In downlink though the loop only runs when a packet is
<em>received</em>, which could stall if there is a problem in the network. Fortunately
the iperf authors anticipated this problem, and provide a fallback timeout!</p>
<p>Unfortunately, this timeout defaults to (a very conservative) two minutes : /</p>
<p>Configuring the timeout was also not exposed in the high-level API yet, but we
were able to add an extension easily along with our earlier efforts. We chose a
value of 5 seconds, which should be long enough for the types of connections we
hope to measure, but still responsive enough for acceptable UX.</p>
<p>This approach of polling the done flag is eerily similar to just checking
<code>is_stopped()</code> (the high-level Java function provided by Worker), but has the
advantage of not needing to make a heavyweight JNI call for each received packet
during the test, and not needing to add JNI code directly into libiperf.
Unfortunately though, this approach now requres us to now reason about threading
and concurrent access to a value in C/C++, something that is not needed in
the regular single-threaded with signals iperf client!</p>
<h3 id="setting-done-from-a-different-thread" class="relative group">Setting done from a different thread <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#setting-done-from-a-different-thread" aria-label="Anchor">#</a></span></h3>
<p>The done flag in particular is polled from the main worker thread, which blocks
on <code>select()</code>, but will need to be set from a different worker thread provided
by the app&rsquo;s WorkManager running <code>onStopped()</code>. To make matters even more
complicated, done is part of the internal to libiperf iperf_test struct, which
is allocated at the beginning of the test and freed at the end of the test. We
need to protect access to the memory in this struct to ensure it is still valid
when accessing it from <code>onStopped()</code>.</p>
<p>Since we only run one test at a time (by design, to prevent the tests from
interfering), it is relatively straightforward to make a singleton holding a
pointer to the current test and a mutex protecting access to the test struct. If
multiple concurrent tests were needed this approach could be extended to
implenting a store of the currently running tests, with some kind of ID system
to get access to the correct test instance.</p>
<p>Tracking the test instance across threads with a singleton test manager is not
particularly elegent or optimized for maximum performance, but is robust,
performant enough, and safe.</p>
<p>So we finally have it all. A means to run iperf tests in the background of our
application, and a means to stop them on demand from the foreground UI. In
testing I start some tests, and stop some tests, and start a test, and then&hellip;
nothing happens. The UI is responsive, but no traffic is being generated for the
latest tests.</p>
<h3 id="learning-to-better-understand-the-worker-contract" class="relative group">Learning to better understand the Worker contract <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#learning-to-better-understand-the-worker-contract" aria-label="Anchor">#</a></span></h3>
<p>It turns out that this is where things get even more complicated. After adding
extensive debug logging and an hour or so of narrowing down on where things get
hung up, it becomes apparent that the mutex protecting the singleton test
manager is locked, preventing new tests from starting without a full restart of
the app. But being modern C++ programmers we were using <code>std::lock_guard</code>, an
<a
  href="https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization"
  
  target="_blank" rel="noreferrer noopener"
>RAII</a>-based
wrapper for scoped mutex ownership. This should be impossible!</p>
<p>After much head scratching and many dead ends, we generate a new hypothesis:
what if the worker thread is somehow &ldquo;killed&rdquo; uncleanly, leaving the process
memory in an invalid state? We add more debug telmetry building an RAII function
entry/exit logger to validate our assumptions and verify that both the main
worker thread and stop signal thread are returning correctly. After around a
dozen tests, it becomes clear that our logging in the cleanup of the JNI
function consistently appears, but the logs at the end of the main function do
not!</p>
<p>At this point, being neither an expert in Java nor Android&rsquo;s latest Java
runtime, it&rsquo;s extremely counter-intuitive to me why background worker threads
would be killed &ldquo;mid-function&rdquo; while the parent process (the application)
remains running. On a hunch, and reading between the lines of the <code>onStopped()</code>
method documentation, we add a
<a
  href="https://developer.android.com/reference/java/util/concurrent/CountDownLatch"
  
  target="_blank" rel="noreferrer noopener"
>CountDownLatch</a>
to our Worker implementation to count down when the native run_test function has
completed, and hold our <code>onStopped()</code> implementation from returning until the
latch is triggered. Lo and behold, our main function exit logging now
consistently appears, and the mutex returns to expected operation.</p>
<p>The <a
  href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/managing-work#onstopped_callback"
  
  target="_blank" rel="noreferrer noopener"
>documentation for onStopped() in the managing work
guide</a>
says:</p>
<blockquote>
<p>WorkManager invokes ListenableWorker.onStopped() as soon as your Worker has
been stopped. Override this method to close any resources you may be holding
onto.</p>
</blockquote>
<p>It may be an implementation detail, or a quirk of the interaction between the
JNI and WorkManager, but should be something to be aware of if you find yourself
using RAII principles to manage long-lived native state in a JNI function. At
the point onStopped() returns it seems <em>all</em> resources must be released,
including resources managed with RAII in your main thread!</p>
<h2 id="epilogue-gracefully-handling-errors" class="relative group">Epilogue: gracefully handling errors <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#epilogue-gracefully-handling-errors" aria-label="Anchor">#</a></span></h2>
<p>After all this, we finally were able to complete our integration of the iperf
tool into our high-level Android testing app. We did encounter one more issue,
which was libiperf 3.10.1 handling test errors (like an unreachable server or
timeout) with and internal call to <code>exit()</code> rather than returning an error code
from the <code>run_client()</code> function! This appears to have been accidental, and was
<a
  href="https://github.com/esnet/iperf/pull/1202"
  
  target="_blank" rel="noreferrer noopener"
>concurrently fixed</a> by <a
  href="https://github.com/ludeeus"
  
  target="_blank" rel="noreferrer noopener"
>Joakim
SÃ¸rensen</a>.</p>
<p>Hopefully as more folks use libiperf externally we can continue to improve the
stability and test coverage of this valuable open-source resource!</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="!mb-0 !mt-0 me-4 h-24 w-24 rounded-full"
          width="96"
          height="96"
          alt="Matt Johnson"
          src="/img/main/profile-square_hu90a91942f541745065cb9f07ffb08452_99838_192x192_fill_q75_box_center.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          Matt Johnson
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">A networking researcher interested in the challenges of infrastructure at the end of the tail of connectivity</div>
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://github.com/matt9j"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://scholar.google.com/citations?user=cTILBksAAAAJ&amp;hl=en"
          target="_blank"
          aria-label="GoogleScholar"
          rel="me noopener noreferrer"
          >

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://keybase.io/matt9j"
          target="_blank"
          aria-label="Keybase"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M286.17 419a18 18 0 1 0 18 18 18 18 0 0 0-18-18zm111.92-147.6c-9.5-14.62-39.37-52.45-87.26-73.71q-9.1-4.06-18.38-7.27a78.43 78.43 0 0 0-47.88-104.13c-12.41-4.1-23.33-6-32.41-5.77-.6-2-1.89-11 9.4-35L198.66 32l-5.48 7.56c-8.69 12.06-16.92 23.55-24.34 34.89a51 51 0 0 0-8.29-1.25c-41.53-2.45-39-2.33-41.06-2.33-50.61 0-50.75 52.12-50.75 45.88l-2.36 36.68c-1.61 27 19.75 50.21 47.63 51.85l8.93.54a214 214 0 0 0-46.29 35.54C14 304.66 14 374 14 429.77v33.64l23.32-29.8a148.6 148.6 0 0 0 14.56 37.56c5.78 10.13 14.87 9.45 19.64 7.33 4.21-1.87 10-6.92 3.75-20.11a178.29 178.29 0 0 1-15.76-53.13l46.82-59.83-24.66 74.11c58.23-42.4 157.38-61.76 236.25-38.59 34.2 10.05 67.45.69 84.74-23.84.72-1 1.2-2.16 1.85-3.22a156.09 156.09 0 0 1 2.8 28.43c0 23.3-3.69 52.93-14.88 81.64-2.52 6.46 1.76 14.5 8.6 15.74 7.42 1.57 15.33-3.1 18.37-11.15C429 443 434 414 434 382.32c0-38.58-13-77.46-35.91-110.92zM142.37 128.58l-15.7-.93-1.39 21.79 13.13.78a93 93 0 0 0 .32 19.57l-22.38-1.34a12.28 12.28 0 0 1-11.76-12.79L107 119c1-12.17 13.87-11.27 13.26-11.32l29.11 1.73a144.35 144.35 0 0 0-7 19.17zm148.42 172.18a10.51 10.51 0 0 1-14.35-1.39l-9.68-11.49-34.42 27a8.09 8.09 0 0 1-11.13-1.08l-15.78-18.64a7.38 7.38 0 0 1 1.34-10.34l34.57-27.18-14.14-16.74-17.09 13.45a7.75 7.75 0 0 1-10.59-1s-3.72-4.42-3.8-4.53a7.38 7.38 0 0 1 1.37-10.34L214 225.19s-18.51-22-18.6-22.14a9.56 9.56 0 0 1 1.74-13.42 10.38 10.38 0 0 1 14.3 1.37l81.09 96.32a9.58 9.58 0 0 1-1.74 13.44zM187.44 419a18 18 0 1 0 18 18 18 18 0 0 0-18-18z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://linkedin.com/in/matt9j"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://orcid.org/0000-0003-2095-0225"
          target="_blank"
          aria-label="Orcid"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M294.75 188.19h-45.92V342h47.47c67.62 0 83.12-51.34 83.12-76.91 0-41.64-26.54-76.9-84.67-76.9zM256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-80.79 360.76h-29.84v-207.5h29.84zm-14.92-231.14a19.57 19.57 0 1 1 19.57-19.57 19.64 19.64 0 0 1-19.57 19.57zM300 369h-81V161.26h80.6c76.73 0 110.44 54.83 110.44 103.85C410 318.39 368.38 369 300 369z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://twitter.com/matt9j"
          target="_blank"
          aria-label="Twitter"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://matt9j.net/posts/integrating-iperf/&amp;subject=Integrating%20Asyncronous%20iperf3%20Tests%20in%20Android%2011&#43;"
          title="Send via email"
          aria-label="Send via email"
          target="_blank"
          rel="noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
  </section>


      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="group flex" href="/posts/building-iperf/">
              <span
                class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&larr;</span
                ><span class="ltr:hidden rtl:inline">&rarr;</span></span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Building iperf3 For Android 11+</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-09-17 00:00:00 &#43;0000 UTC">September 17, 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12">
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10">
  
  
  <div class="flex justify-between">
    <div>
      
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2023
          Matt Johnson
      </p>
      
      
        <p class="text-xs text-neutral-400 dark:text-neutral-600">
          
          
          Powered by <a class="hover:underline hover:underline-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:underline-primary-400 hover:text-primary-500" href="https://github.com/matt9j/congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    
    
  </div>
  
  
</footer>

    </div>
  </body>
</html>
